---
title: "my title"
author: "Dummy Surname (dummy@mail.com)"
date: "Last update: `r format(Sys.time(), '%d %B, %Y')`"      
output:
  html_document:
    toc: true
    fig_caption: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


# Analysis of the Heart Disease Dataset 
Load the data from
[here](https://raw.githubusercontent.com/jpinero/DMI_2021/main/datasets/heart_disease_dataset.csv), and the description is [here](https://raw.githubusercontent.com/jpinero/DMI_2021/main/datasets/heart_disease_description.txt). 
The original dataset comes from [here](https://archive.ics.uci.edu/ml/datasets/Heart+Disease) and corresponds to the [processed cleveland data](https://archive.ics.uci.edu/ml/machine-learning-databases/heart-disease/processed.cleveland.data)

## Perform an EDA on the dataset

```{r}

# Load the dataset
heart_data <- read.csv("/home/wael-badr/Desktop/UPF/2nd_trimester/DMI/assignment-1-OOWaelOO/data/heart_disease_dataset.csv", sep = " ", header = TRUE, stringsAsFactors = FALSE)


```


## Create visualizations in order to show which variables seem to be more associated with heart disease

```{r}

```


# 2 Difference in mortality rates in hospitalized COVID-19 patients 
Using the supplementary material from the [Difference in mortality rates in hospitalized COVID-19 patients identified by cytokine profile clustering using a machine learning approach: An outcome prediction alternative](https://www.frontiersin.org/articles/10.3389/fmed.2022.987182/full), perform the following tasks

## Reproduce Figure 1 from the publication

```{r}

library(readxl)
library(dplyr)
library(lubridate)

file_path <- "/home/wael-badr/Downloads/Table_1.XLSX"
datos <- read_excel(file_path, sheet = "Datos")

# Replace "NI" with NA for missing data
datos <- datos %>%
  mutate(across(everything(), ~na_if(., "NI")))

# Convert date columns to Date format
datos <- datos %>%
  mutate(
    `Syntoms onset` = ymd(`Syntoms onset`),
    `Hospitalization date` = ymd(`Hospitalization date`)
  )

# Convert numeric columns to appropriate types
numeric_columns <- c("BMI", "Days in ICU", "Days with ARDS", "Days with CRS",
                     "Days with NIV", "Days with AMV", "Days of hospitalization")
datos <- datos %>%
  mutate(across(all_of(numeric_columns), as.numeric))

# Standardize Yes/No columns as logical (TRUE/FALSE)
yes_no_columns <- c("Admission to ICU", "ARDS Diagnosis", "CRS Diagnosis",
                    "Use of NIV", "Use of AMV", "Death")
datos <- datos %>%
  mutate(across(all_of(yes_no_columns), ~case_when(
    . == "Yes" ~ TRUE,
    . == "No" ~ FALSE,
    TRUE ~ NA
  )))

# Remove duplicate entries
datos <- datos %>%
  distinct()

# Rename columns for clarity
datos <- datos %>%
  rename(
    Symptoms_Onset = `Syntoms onset`,
    Hospitalization_Date = `Hospitalization date`,
    BMI = BMI,
    Days_in_ICU = `Days in ICU`,
    Days_with_ARDS = `Days with ARDS`,
    Days_with_CRS = `Days with CRS`,
    Days_with_NIV = `Days with NIV`,
    Days_with_AMV = `Days with AMV`,
    Hospitalization_Days = `Days of hospitalization`,
    ICU_Admission = `Admission to ICU`,
    ARDS = `ARDS Diagnosis`,
    CRS = `CRS Diagnosis`,
    NIV_Usage = `Use of NIV`,
    AMV_Usage = `Use of AMV`,
    Death = Death
  )


```


## Reproduce Figure 2 from the publication
but instead of representing the clusters in the annotation, represent the groups (G1 to G4)

```{r}

```

## Improve figure 2 of the publication
Add a second annotation with information of deathm and a third one with information of gender

```{r}

```


# session info {.unnumbered}

```{r, results='asis',  echo=FALSE, message=FALSE }
sessionInfo()
```
